<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="room"></a><a href="http://ask.wireshark.org/questions/10173/covert-the-pcap-file-to-a-csv-file-using-tshark"><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">C</span></a><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">overt the .pcap file to a .csv file using tshark</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="item-right"></a>What is the &quot;tshark&quot; command for to converting the .pcap file to a .csv file? The packet capture data will be monitored using Splunk. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="question-tags"></a><a href="http://ask.wireshark.org/tags/conversion/"><span style=" text-decoration: underline; color:#0000ff;">c</span></a><span style=" text-decoration: underline; color:#0000ff;">onversion</span> <a href="http://ask.wireshark.org/tags/csv/"><span style=" text-decoration: underline; color:#0000ff;">csv</span></a> <a href="http://ask.wireshark.org/tags/pcap/"><span style=" text-decoration: underline; color:#0000ff;">pcap</span></a> <a href="http://ask.wireshark.org/tags/tshark/"><span style=" text-decoration: underline; color:#0000ff;">tshark</span></a> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p></td></tr></table>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="sort-top"></a>One Answer: </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://ask.wireshark.org/questions/10173/covert-the-pcap-file-to-a-csv-file-using-tshark?sort=oldest"><span style=" text-decoration: underline; color:#0000ff;">oldest</span></a><a href="http://ask.wireshark.org/questions/10173/covert-the-pcap-file-to-a-csv-file-using-tshark?sort=newest"><span style=" text-decoration: underline; color:#0000ff;">newest</span></a><a href="http://ask.wireshark.org/questions/10173/covert-the-pcap-file-to-a-csv-file-using-tshark?sort=votes"><span style=" text-decoration: underline; color:#0000ff;">most voted</span></a> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-container-10193"></a>1 </p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post-10193-downvote"></a>That depends on which particular fields you want to use in the CSV file. Once you've decided which named fields to put into the CSV file, then you would run a command such as</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">tshark -T fields -n -r {the pathname of the capture file} -E separator=, -e {first field name} -e {second field name} ... &gt;{the pathname of the output file}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">where {the pathname of the capture file} is the pathname of the capture file you're reading and {first field name}, {second field name} and so on are the names of the fields, and {the pathname of the output file} is the pathname of the output file, for example</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">tshark -T fields -n -r capture.pcap -E separator=, -e ip.src -e ip.dst ... &gt;</span><a href="http://output.txt"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0000ff;">output.txt</span></a></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://ask.wireshark.org/answer_link/10193/"><span style=" text-decoration: underline; color:#0000ff;">link</span></a> </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-container-10193"></a>How do i specify the output csv file pathname into this tshark command above?? </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-10255-info"></a>(18 Apr '12, 17:52) <a href="http://ask.wireshark.org/users/2503/misteryuku"><span style=" text-decoration: underline; color:#0000ff;">misteryuku</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-10257"></a>I've updated the anser to show that, and gave an example. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-10257-info"></a>(18 Apr '12, 23:41) <a href="http://ask.wireshark.org/users/79/guy-harris"><span style=" text-decoration: underline; color:#0000ff;">Guy Harris ♦♦</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-10260"></a>What does &quot;this&quot; in &quot;so this applies to a .txt file...&quot; refer to? </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">The <span style=" font-style:italic;">text output</span> of TShark is specified by redirecting its output to a file no matter <span style=" font-style:italic;">what</span> type of output is produced. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">The <span style=" font-family:'Courier New,courier';">-T fields</span>, <span style=" font-family:'Courier New,courier';">-E separator=,</span>, and <span style=" font-family:'Courier New,courier';">-e</span> flags applies to a <span style=" font-style:italic;">CSV</span> file, which means that each line contains a Comma-Separated list of Values, with <span style=" font-style:italic;">NO</span> keys. There <span style=" font-style:italic;">IS</span> no option to TShark to make it produce output with key=value pairs. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-10260-info"></a>(18 Apr '12, 23:56) <a href="http://ask.wireshark.org/users/79/guy-harris"><span style=" text-decoration: underline; color:#0000ff;">Guy Harris ♦♦</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-10263"></a>okay i see besides outputting the ip.src and the ip.dst , what is the syntax for outputting the values for no, time, protocol, length and Info field column names from the Wireshark Graphical User Interface?? </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-10263-info"></a>(19 Apr '12, 00:05) <a href="http://ask.wireshark.org/users/2503/misteryuku"><span style=" text-decoration: underline; color:#0000ff;">misteryuku</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-10264"></a>There are no fields corresponding to the protocol and info columns, so you'd have to do something such as </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">tshark -n -r {the pathname of the capture file}</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">to have it print out the columns. The output would <span style=" font-style:italic;">NOT</span> be comma-separated, and would <span style=" font-style:italic;">NOT</span> have key= tags; it would look something like </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">1   0.000000 xxx.xxx.xxx.xxx -&gt; xxx.xxx.xxx.xxx TCP 54 5165 &gt; http [SYN] Seq=0 Win=16384 Len=0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">2   0.000001 xxx.xxx.xxx.xxx -&gt; xxx.xxx.xxx.xxx TCP 54 14378 &gt; http [SYN] Seq=0 Win=16384 Len=0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">3   0.000003 xxx.xxx.xxx.xxx -&gt; xxx.xxx.xxx.xxx TCP 54 31944 &gt; http [SYN] Seq=0 Win=16384 Len=0</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="room"></a><a href="http://ask.wireshark.org/questions/11809/how-to-filter-from-field-in-http-header"><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">H</span></a><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">ow to filter From field in HTTP header?</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="main-body"></a>0 </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="favorite-count"></a>Hi, I want to filter &quot;From: &quot; field in HTTP header of a packet but it seems wireshark doesn't understands that field. I am using wireshark verison 1.6.8.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">What should be done to resolve this issue? Is there any newer version which supports this field?</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Thanks, Ravi </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="question-tags"></a><a href="http://ask.wireshark.org/tags/http/"><span style=" text-decoration: underline; color:#0000ff;">h</span></a><span style=" text-decoration: underline; color:#0000ff;">ttp</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p></td></tr></table>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="sort-top"></a>2 Answers: </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://ask.wireshark.org/questions/11809/how-to-filter-from-field-in-http-header?sort=oldest"><span style=" text-decoration: underline; color:#0000ff;">oldest</span></a><a href="http://ask.wireshark.org/questions/11809/how-to-filter-from-field-in-http-header?sort=newest"><span style=" text-decoration: underline; color:#0000ff;">newest</span></a><a href="http://ask.wireshark.org/questions/11809/how-to-filter-from-field-in-http-header?sort=votes"><span style=" text-decoration: underline; color:#0000ff;">most voted</span></a> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-container-11812"></a>0 </p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post-11812-downvote"></a>According to <a href="http://www.faqs.org/rfcs/rfc2616.html"><span style=" text-decoration: underline; color:#0000ff;">RFC2616</span></a> <span style=" font-family:'Courier New,courier'; font-weight:600;">From:</span> is a request header field.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">This works on my system:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">http.request and http contains &quot;From: &quot;</span><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">HOWEVER, this will only filter those requests with that string somewhere in the request. If you want to get the content of the field, there are these options:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">run tshark with these options and parse the output with a script (find is just a simple example):<br /></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">tshark -r http_from_sample.cap -R &quot;http.request and http contains From:&quot; -V | find &quot;From:&quot;</span><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Write a <a href="http://www.wireshark.org/docs/wsug_html_chunked/wsluarm.html"><span style=" text-decoration: underline; color:#0000ff;">Lua Listener or Post-Dissector</span></a></li>
<li style="" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Extend the HTTP dissector to offer <span style=" font-family:'Courier New,courier'; font-weight:600;">http.from</span> or <span style=" font-family:'Courier New,courier'; font-weight:600;">http.request_header.from</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Regards<br />Kurt </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://ask.wireshark.org/answer_link/11812/"><span style=" text-decoration: underline; color:#0000ff;">link</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">answered <span style=" font-weight:600;">11 Jun '12, 09:03</span> <img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" width="32" height="32" /> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">I tried both the options but I am getting nothing in output. Can you suggest any other option? or writing a dissector is the last option. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Regards, Ravi </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-11813-info"></a>(11 Jun '12, 09:23) <a href="http://ask.wireshark.org/users/2822/ravi_tandon"><span style=" text-decoration: underline; color:#0000ff;">RAVI_TANDON</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-11814"></a>1 </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">maybe there is no <span style=" font-family:'Courier New,courier'; font-weight:600;">From:</span> header in your data. Please try my sample capture. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><a href="http://cloudshark.org/captures/132afd675db4"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0000ff;">http://cloudshark.org/captures/132afd675db4</span></a><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">See frame #4. My filter works even on cloudshark. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-11814-info"></a>(11 Jun '12, 09:30) <a href="http://ask.wireshark.org/users/2593/kurt-knochner"><span style=" text-decoration: underline; color:#0000ff;">Kurt Knochner ♦</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-11817"></a>Yeah...its indeed working on your sample capture. But its not working on my capture at: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://cloudshark.org/captures/479d04160629"><span style=" text-decoration: underline; color:#0000ff;">http://cloudshark.org/captures/479d04160629</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">It will be really helpful if you can comment that why its not working on my capture? </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Thanks, Ravi </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-11817-info"></a>(11 Jun '12, 11:28) <a href="http://ask.wireshark.org/users/2822/ravi_tandon"><span style=" text-decoration: underline; color:#0000ff;">RAVI_TANDON</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-11826"></a>Dissection of your GPRS-Tunneled data stops at the TCP level, so there are no HTTP fields available. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-11826-info"></a>(11 Jun '12, 12:45) <a href="http://ask.wireshark.org/users/2593/kurt-knochner"><span style=" text-decoration: underline; color:#0000ff;">Kurt Knochner ♦</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-11838"></a>2 </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">There is a problem with the request. http1.cap does not end with a single CRLF (0x0d0a). Actually it's two CRLF. One for the last request header and one for an &quot;empty line&quot;. The HTTP RFC defines this as a marker for the end of the request headers. Wireshark does not accept that as a valid HTTP request. I changed the last few bytes with a HEX editor and now the HTTP request gets dissected. Please check your GPRS encapsulation or the tool that generates the HTTP request. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-11838-info"></a>(11 Jun '12, 14:13) <a href="http://ask.wireshark.org/users/2593/kurt-knochner"><span style=" text-decoration: underline; color:#0000ff;">Kurt Knochner ♦</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-tools-11812"></a>showing 5 of 7 <a href="http://ask.wireshark.org/questions/11809/how-to-filter-from-field-in-http-header#"><span style=" text-decoration: underline; color:#0000ff;">show 2 more comments</span></a> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p></td></tr></table>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="11815"></a>2 </p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post-11815-downvote"></a>Wireshark allows configuring the HTTP dissector to parse custom header fields, allowing you to access the header field with display-filter syntax:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">http.header.From</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">This requires no code modification or scripting. Follow the instructions from a similar <a href="http://ask.wireshark.org/questions/6270/how-to-create-a-filter-for-a-particular-field"><span style=" text-decoration: underline; color:#0000ff;">post</span></a>. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="room"></a><a href="http://ask.wireshark.org/questions/6270/how-to-create-a-filter-for-a-particular-field"><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">H</span></a><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">ow to create a filter for a particular field?</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="main-body"></a>0 </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="favorite-count"></a>Hi, I want to create a display filter for a particular field. Please help me to finish my task.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">HTTP Header:</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Hypertext Transfer Protocol</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">POST / HTTP/1.1\r\n</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Content-Type: text/xml; charset=utf-8\r\n</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">SOAPAction: &quot;create&quot;\r\n</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Here, I want to create filter for the &quot;SOAPAction&quot; field. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="question-tags"></a><a href="http://ask.wireshark.org/tags/http/"><span style=" text-decoration: underline; color:#0000ff;">h</span></a><span style=" text-decoration: underline; color:#0000ff;">ttp</span> <a href="http://ask.wireshark.org/tags/soap/"><span style=" text-decoration: underline; color:#0000ff;">soap</span></a> <a href="http://ask.wireshark.org/tags/display-filter/"><span style=" text-decoration: underline; color:#0000ff;">display-filter</span></a> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p></td></tr></table>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="sort-top"></a>One Answer: </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://ask.wireshark.org/questions/6270/how-to-create-a-filter-for-a-particular-field?sort=oldest"><span style=" text-decoration: underline; color:#0000ff;">oldest</span></a><a href="http://ask.wireshark.org/questions/6270/how-to-create-a-filter-for-a-particular-field?sort=newest"><span style=" text-decoration: underline; color:#0000ff;">newest</span></a><a href="http://ask.wireshark.org/questions/6270/how-to-create-a-filter-for-a-particular-field?sort=votes"><span style=" text-decoration: underline; color:#0000ff;">most voted</span></a> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-container-6274"></a>5 </p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post-6274-downvote"></a>The <a href="http://www.wireshark.org/docs/dfref/h/http.html"><span style=" text-decoration: underline; color:#0000ff;">HTTP field list</span></a> doesn't include <span style=" font-family:'Courier New,courier';">SOAPAction</span>, so <span style=" font-family:'Courier New,courier';">SOAPAction</span> is added as a simple text item. You can filter for it in a couple ways:</p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Option 1: Custom HTTP header field</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Add a custom header field to your HTTP preferences (requires Wireshark restart), which allows you to filter for the field.</p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Open menu: <span style=" font-weight:600;">Edit &gt; Preferences &gt; Protocols &gt; HTTP &gt; Custom HTTP headers fields</span></li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Click <span style=" font-weight:600;">New</span></li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">For <span style=" font-weight:600;">Header name</span>, enter <span style=" font-weight:600;">SOAPAction</span></li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">For <span style=" font-weight:600;">Field desc</span>, enter <span style=" font-weight:600;">Intent of SOAP HTTP request</span> (or whatever)</li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Click <span style=" font-weight:600;">OK</span></li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Restart Wireshark.</li>
<li style="" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">In the <span style=" font-style:italic;">Display Filter textbox</span>, enter <span style=" font-weight:600;">http.header.SOAPAction</span>, and click <span style=" font-weight:600;">Apply</span>. The textbox background should turn green, indicating the display filter syntax is correct (and that our preference changes for the custom field <span style=" font-family:'Courier New,courier';">SOAPAction</span> took effect).</li></ol>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Option 2: String matching display filter</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">This display filter scans entire HTTP packets for the string &quot;SOAPAction:&quot;. This might be inefficient compared to a custom HTTP header field, but it works well.</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">http contains &quot;SOAPAction:&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </pre></td></tr></table></td></tr></table></td></tr></table></body></html>