<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<p><span style="font-family:Sans Serif;"><span style="font-size:9pt;"><a href="http://eddnet.org/?p=1311">Bash учебное пособие. Часть 6: Структура If…then…else</a> </span></span></p>
<p>&nbsp;<p>if...else...fi позволяют вам сделать выбор основанный на справедливости выражения. Как пример, определить существует ли файл или нет, и в зависимости от этого предпринять какие-то действия.</p>
<p>&nbsp;<p>If...then...else...fi синтаксис:</p>
<p>?if [ условие ]</p>
<p>then</p>
<p> если условие справедливо</p>
<p> выполнить все команды до else или</p>
<p> до fi</p>
<p>else</p>
<p> если условие не справедливо</p>
<p> выполнить все команды до fi</p>
<p>fi</p>
<p>&nbsp;<p>&nbsp;<p>Очень важно запомнить, ваша конструкция должна всегда заканчиваться на словом fi!</p>
<p>&nbsp;<p>Выражения используемые с if</p>
<p>&nbsp;<p>В приведенной внизу таблице содержаться операторы которые выполняют команду test или набор команд. Эти операторы заключаются в квадратные скобки [] для проверки выполнения условия.</p>
<p>?[ -a FILE ] Правда елси FILE существует.</p>
<p>[ -b FILE ] Правда елси FILE существует и это специальный блоковый файл.</p>
<p>[ -c FILE ] Правда елси FILE существует и это специальный знаковый файл.</p>
<p>[ -d FILE ] Правда елси FILE существует и это директория.</p>
<p>[ -e FILE ] Правда елси FILE существует.</p>
<p>[ -f FILE ] Правда елси FILE существует и это регулярный файл.</p>
<p>[ -g FILE ] Правда елси FILE существует и установлен SGID бит.</p>
<p>[ -h FILE ] Правда елси FILE существует и это символический ссылка.</p>
<p>[ -k FILE ] Правда елси FILE существует и второй промежуточный бит округления установлен.</p>
<p>[ -p FILE ] Правда елси FILE существует и это named pipe (FIFO).</p>
<p>[ -r FILE ] Правда елси FILE существует и он доступен на чтение.</p>
<p>[ -s FILE ] Правда елси FILE существует и больше нуля.</p>
<p>[ -u FILE ] Правда елси FILE существует и SUID (set user ID) бит установлен.</p>
<p>[ -w FILE ] Правда елси FILE существует и он доступен на запись.</p>
<p>[ -x FILE ] Правда елси FILE существует и он доступен на исполнение.</p>
<p>[ -O FILE ] Правда елси FILE существует принадлежит существующему пользователю</p>
<p>[ -G FILE ] Правда елси FILE существует принадлежит существующей группе.</p>
<p>[ -L FILE ] Правда елси FILE существует и это символический ссылка.</p>
<p>[ -N FILE ] Правда елси FILE существует и был изменен с тех пор как был прочитан.</p>
<p>[ -S FILE ] Правда елси FILE существует и это сокет.</p>
<p>[ FILE1 -nt FILE2 ] Правда, если файл FILE1 изменялся чаще чем FILE2, или есои FILE1 существует, а FILE2 нет.</p>
<p>[ FILE1 -ot FILE2 ] Правда, если файл FILE1 старше чем FILE2, или FILE1 существует, а FILE2 нет.</p>
<p>[ FILE1 -ef FILE2 ] Правда, если FILE1 и FILE2 относятся к одному устройству и номеру инода.</p>
<p>[ -o OPTIONNAME ] Правда если shell опция &quot;OPTIONNAME&quot; включена.</p>
<p>[ -z STRING ] Правда если длинна &quot;STRING&quot; равна 0.</p>
<p>[ -n STRING ] or [ STRING ] Правда если длинна &quot;STRING&quot; не равна 0.</p>
<p>[ STRING1 == STRING2 ] Правда если выражения эквивалентны. </p>
<p>[ STRING1 != STRING2 ] Правда если выражения не эквивалентны.</p>
<p>[ STRING1 &lt; STRING2 ] Правда если &quot;STRING1&quot; лексикографически упорядоченно до &quot;STRING2&quot;.</p>
<p>[ STRING1 &gt; STRING2 ] Правда если &quot;STRING1&quot; лексикографически упорядоченно после &quot;STRING2&quot;.</p>
<p>[ ARG1 OP ARG2 ] &quot;OP&quot; это один из следующих параметров -eq, -ne, -lt, -le, -gt or -ge. Эти бинарные арифметические </p>
<p>операторы возвращают результат &quot;правда&quot; если &quot;ARG1&quot; эквивалентен(-eq), не эквивалентен(-ne), меньше чем(-lt), </p>
<p>меньше или эквивалентен(-le), больше чем(-gt), больше или эквивалентно(-ge) к &quot;ARG2&quot;.  </p>
<p>[ ! EXPR ] правда если выражение EXPR не справедливо.</p>
<p>[ ( EXPR ) ] возвращает значение EXPR. Это может быть использовано для изменения приоритета операторов.</p>
<p>[ EXPR1 -a EXPR2 ] правда, если оба выражения EXPR1 и EXPR2 справедливы.</p>
<p>[ EXPR1 -o EXPR2 ] правда, если хотя бы одно выражение EXPR1 или EXPR2 справедливы.</p>
<p>&nbsp;<p>&nbsp;<p>Давайте перейдем к примерам. Создадим скрипт который будет определять положительное или отрицательное введенное нами число:</p>
<p>?#!/bin/bash</p>
<p>read -p &quot;Введите число : &quot; n</p>
<p>if [ $n -ge 0 ];</p>
<p>then</p>
<p>      echo &quot;$n положительное число.&quot;</p>
<p>else</p>
<p>      echo &quot;$n отрицательное число.&quot;</p>
<p>fi</p>
<p>&nbsp;<p>&nbsp;<p>другой пример, определим, существует ли введенный нами пользователь:</p>
<p>?#!/bin/bash</p>
<p>read -p &quot;Введите имя пользователя : &quot; USER</p>
<p>if ! grep $USER /etc/passwd</p>
<p>then</p>
<p>      echo &quot;$n не существует.&quot;</p>
<p>else</p>
<p>      echo &quot;$n существует.&quot;</p>
<p>fi</p>
<p>&nbsp;<p>&nbsp;<p>Восклицательный знак перед grep $USER /etc/passwd, говорит о том, что условие выполниться если пользователя не существует. А теперь давайте перепишем этот скрипт только используя специальный параметр $? который мы рассматривали в третем уроке:</p>
<p>?#!/bin/bash</p>
<p>read -p &quot;Введите имя пользователя : &quot; USER</p>
<p>grep $USER /etc/passwd</p>
<p>if [ $? -ne 0 ]; </p>
<p>then</p>
<p>      echo &quot;$n не существует.&quot;</p>
<p>else</p>
<p>      echo &quot;$n существует.&quot;</p>
<p>fi</p>
<p>&nbsp;<p>&nbsp;<p>Пример использование сравнения строк. скрипт будет проверять root вы или нет:</p>
<p>?#!/bin/bash</p>
<p>if [ &quot;$(whoami)&quot; != 'root' ]; then</p>
<p>        echo &quot;У вас нет прав для запуска $0.&quot;</p>
<p>        exit 1;</p>
<p>fi</p>
<p>&nbsp;<p>&nbsp;<p>данный скрипт можно переписать короче:</p>
<p>?#!/bin/bash</p>
<p>[ &quot;$(whoami)&quot; != 'root' ] &amp;&amp; ( echo У вас нет прав для запуска; exit 1 )</p>
<p>&nbsp;<p>&nbsp;<p>Вы так же можете использовать регулярные выражения. Как пример. пускай наш скрипт определяет содержит ли введенный нам текст букву &quot;ч&quot;:</p>
<p>?#!/bin/bash</p>
<p>LATTER=&quot;ч&quot;</p>
<p>read -p &quot;Введите предложение : &quot; STR</p>
<p>if [[ &quot;$STR&quot; == *$LATTER* ]]; </p>
<p>then</p>
<p>      echo &quot;$LATTER найдено.&quot;</p>
<p>else</p>
<p>      echo &quot;$LATTER не найдено.&quot;</p>
<p>fi</p>
<p>&nbsp;<p>&nbsp;<p>Несколько слов по поводу использования двойных и одинарных квадратных скобок. При использовании двойных скобок ваши переменный не будут разбиты на несколько отдельных слов если вы использовали пробел, как пример, переменная VAR=&quot;var with space&quot; будет единым целым.</p>
<p>&nbsp;<p>Часть 1: скрипт Hellow World </p>
<p>Часть 2: Переменные </p>
<p>Часть 3: Специальные параметры </p>
<p>Часть 4: Одинарные и двойные кавычки. Математические операции</p>
<p>Часть 5: Структурные конструкции и команда test </p>
<p>Часть 6: Структура If...then...else </p>
<p>Часть 7: Подмножества и части строк. Размеры </p>

</p></body></html>
