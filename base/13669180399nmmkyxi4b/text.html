<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<p><span style="font-family:Sans Serif;"><span style="font-size:9pt;"><a href="http://citforum.ru/operating_systems/unixuser/gl10_9.shtml">10.9. Регулярные выражения</a> </span></span></p>
<p>&nbsp;<p>awk обеспечивает более мощные шаблоны для поиска строки символов, чем сравнение. Такие шаблоны называются регулярными выражениями. Простейшим регулярным выражением является строка символов, обрамленная знаками &quot;/&quot;. Например: </p>
<p>	/Asia/</p>
<p>&nbsp;<p>Эта программа печатает все записи, которые содержат подстроку Asia (запись, содержащая Asia как часть длинной строки, подобной Asian или Pan-Asiatic, также печатается). </p>
<p>&nbsp;<p>Чтобы ограничить поиск только для специального поля, вы можете использовать операторы ~(входит) и !~(не входит). Программа: </p>
<p>	$4 ~ /Asia/ { print $1 }</p>
<p> печатает первое поле всех тех строк, в которых четвертое поле - Asia, в то время как программа: </p>
<p>	$4 !~ /Asia/ { print $1 }</p>
<p> печатает первое поле всех тех строк, в которых четвертое поле - не Asia. </p>
<p>&nbsp;<p>В регулярном выражении могут использоваться метасимволы: </p>
<p>	\, ^, $, ., [, ], *, ?, (, ), |</p>
<p> которые подобны метасимволам, используемым в shell. Например, метасимволы &quot;^&quot; и &quot;$&quot; осуществляют поиск соответственно начала и конца строки, а метасимвол &quot;.&quot; ищет одиночный символ. Например: </p>
<p>	/^.$/</p>
<p> просматривает все записи для поиска записи, состоящей из одного символа. </p>
<p>&nbsp;<p>Если группа символов заключена в квадратные скобки, то это означает поиск одного символа из этой группы. Например, /[ABC]/ - осуществляет поиск либо символа &quot;A&quot;, либо &quot;B&quot;, либо &quot;C&quot;. Границы букв или цифр могут быть обозначены внутри квадратных скобок: </p>
<p>	/[a-zA-Z]/</p>
<p> Если первым символом после &quot;[&quot; является символ &quot;^&quot;, то это означает: любой символ, не входящий в набор. Например: </p>
<p>	/[^a-zA-Z]/</p>
<p> означает поиск любого символа, кроме буквы. </p>
<p>&nbsp;<p>Символ &quot;+&quot; означает &quot;один или больше&quot;. Например, программа: </p>
<p>	$2 !~ /^[0-9]+$/</p>
<p> печатает все записи, в которых второе поле не является строкой из одной или более цифр. (^ - начало строки, [0-9]+ - одна или более цифр, $ -конец строки). </p>
<p>&nbsp;<p>Круглые скобки используются для группирования символов, а символ | для указания альтернативы. Программа: </p>
<p>	/(apple|cherry) (pie|tart)/</p>
<p> осуществляет поиск строк, содержащих одну из 4-х подстрок: </p>
<p>        apple pie</p>
<p>        apple tart</p>
<p>        cherry pie</p>
<p>        cherry tart </p>
<p>&nbsp;<p>Чтобы отменить специальное значение метасимвола, поставьте знак &quot;\&quot; перед ним. Например: </p>
<p>	/b\$/</p>
<p> печатает все строки, содержащие символ &quot;b&quot; и следующий за ним знак &quot;$&quot;. </p>
<p>&nbsp;<p>В дополнение к распознаваемым метасимволам, awk распознает следующие последовательности языка программирования Си внутри регулярных выражений и строк: </p>
<p> \b - возврат </p>
<p> \f - перевод формата </p>
<p> \n - новая строка </p>
<p> \r - возврат каретки </p>
<p> \t - табуляция </p>
<p> \ddd - восьмиричное значение </p>
<p> \&quot; - кавычки </p>
<p> \c - с </p>
<p>&nbsp;<p>Например, чтобы напечатать все строки, содержащие табуляцию, воспользуйтесь программой: </p>
<p>	/\t/</p>
<p>&nbsp;<p>awk интерпретирует любую строку или переменную справа от символа &quot;~&quot; или &quot;!~&quot; как регулярное выражение. Например, мы можем записать программу: </p>
<p>	$2 !~ /^[0-9]+$/</p>
<p> как </p>
<p>      BEGIN { digits = &quot;^[0-9]+&amp;&quot; }</p>
<p>         $2 !~ digits </p>
<p>&nbsp;<p>Предположим, что нужно найти строку символов, подобную ^[0-9]+$. Если строка &quot;^[0-9]+$&quot; используется как регулярное выражение, появляются дополнительные знаки &quot;\&quot;, которые защищают регулярное выражение. Это связано с тем, что первый уровень знаков &quot;\&quot; удаляется при синтаксическом анализе строки. Первый уровень &quot;\&quot; перед символом возвращает его специальное значение в регулярном выражении, второй нужен, чтобы защитить его в строке. </p>
<p>&nbsp;<p>Например, нужно найти строки, содержащие &quot;b&quot; и следующий за ним знак &quot;$&quot;. Регулярное выражение для этого шаблона: </p>
<p>	b\$</p>
<p>&nbsp;<p>Чтобы создать строку для представления этого регулярного выражения, необходимо добавить еще один символ &quot;\&quot;: </p>
<p>	&quot;b\\$&quot;</p>
<p>&nbsp;<p>Следующие регулярные выражения попарно эквивалентны: </p>
<p>        x ~ &quot;b\\$&quot;      x ~ /b\$/</p>
<p>        x ~ &quot;b\$&quot;       x ~ /b$/</p>
<p>        x ~ &quot;b$&quot;        x ~ /b$/</p>
<p>        x ~ &quot;\\t&quot;       x ~ /\t/</p>
<p>&nbsp;<p>Регулярные выражения и подстроки, поиск которых они осуществляют, приведены в табл. 22. </p>
<p>&nbsp;<p>Унарные операции *, +, ? имеют наивысший приоритет, затем конкатенация и затем альтернативный выбор |. </p>
<p>&nbsp;<p>Таблица 22 </p>
<p>Регулярные выражения </p>
<p> Выражение 	 Действие </p>
<p> с 	 Любой, отличный от &quot;с&quot; мета-символ </p>
<p> \с 	 Символ &quot;с&quot; </p>
<p> ^ 	 Начало строки </p>
<p> $ 	 Конец строки </p>
<p> . 	 Любой символ, кроме новой строки </p>
<p> [s] 	 Любой символ из набора &quot;s&quot; </p>
<p> [^s] 	 Любой символ, не входящий в набор &quot;s&quot; </p>
<p> r* 	 Ноль или больше </p>
<p> r+ 	 Один или больше </p>
<p> r? 	 Ноль или один </p>
<p> (r) 	 r </p>
<p> r1r2 	 Соединить r1 и r2 </p>
<p> r1|r2 	 r1 или r2</p>

</p></body></html>
